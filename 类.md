# 类

## 类的定义

类只是一个模板，编译后不占用内存空间，所以在类定义时不能对成员变量进行初始化，因为没有地方存储数据，只有在创建对象以后才会个成员变量分配内存。

类可以理解为一个新的数据类型。类名的首字母通常大写。

## 访问类的成员

通过**栈**的方式：

```c++
class Student{
public:
	***    
};

Student stu;
stu.***;
```

通过**堆**的方式（使用对象指针）

```c++
Student *pStu=new Student;
pStu->***;
delete pStu;
```

通过new在堆上创建的对象是匿名的，必须用一个指针指向它，再借助指针来访问它的成员变量或者成员函数。栈是程序自动管理的，堆内存由程序员进行管理，使用完毕后必须用**delete**进行删除

## 成员的访问权限及封装

private、public、protected。

类的内部（定义类的代码内部），无论成员变量是如何声明，都可以互相访问

类的外部（定义类的代码之外），只能通过对象访问public属性的成员。

成员变量大都以`m_`开头，这是约定俗成的写法。

private关键字的作用在于更好的隐藏类的内部实现，该向外暴露的接口（能通过对象访问的成员）都声明为public，这种就是类的封装性。

## 构造函数

如果用户没有自定义构造函数，编译器会生成一个默认的构造函数，默认构造函数是无参的，一旦用户自定义构造函数，则系统不在自动生成默认构造函数。

构造函数是允许重载的，创建对象时根据传递的实参来判断调用哪一个构造函数。自定义有参构造函数，则不可以创建空的类对象。

```c++
class Student{
private:
    int m_num;
public:
    //增加：Student()
    Student(int age):m_age(age);
};

//错误，构造函数参数不匹配。需要增加空构造函数
Student *pStu=new Student;
Student stu;

```

构造函数的调用具有强制性，一旦类中定义构造函数，必须要有一个构造函数被调用。

**初始化const成员变量的唯一方法就是使用初始化列表。**

## this指针

this是一个const指针，指向当前对象，通过它可以访问当前对象的所有成员，用`->`来访问成员变量或者成员函数。

几点注意：

- this是const指针，它的值是不能被修改的，一切企图修改指针的操作，如递增、赋值、递减都是非法的。
- this只能在成员函数内部使用，用在其他地方没有意义。
- 只有当对象被创建后this才有意义，因此不能在static成员函数中使用

this本质上是成员函数的一个形参，在调用成员函数时将对象的地址作为实参传递给this，不过this这个形参是隐式的。

## static静态成员变量

static修饰的变量是静态成员变量，其属于类，为多个对象共享。

- 一个类中可以有一个或者多个静态成员变量，所有的对象都共享这些成员变量

- static成员和普通static变量一样，都在内存分区中的全局数据区分配内存，到程序结束时才释放。这就说明，static成员变量不随对象的创建而分配内存，也不随对象的销毁而释放内存。

- 静态成员变量必须初始化，而且只能在类的体外进行初始化。

  ```c++
  //通过类访问static变量
  Student::m_total=10;
  //通过对象来访问
  Student stu;
  stu.m_total=10;
  //通过对象指针来访问
  Student *pStu=new Student;
  pStu->m_toal=10;
  ```

  初始化时可以赋初值，也可以不赋值，不赋值会默认初始化为0.全局数据区的变量都有默认初始值0，动态数据区（堆区和栈区）变量的默认值，一般认为是垃圾值。

- 静态成员变量既可以通过对象名访问，也可以通过类名访问，但是要遵循private、protected和public的限制

## static静态成员函数

编译器在编译一个普通成员函数，会隐式的增加一个形参this，并把当前对象的地址赋值给this，所以普通成员函数只能在创建对象后通过对象来调用，因为它需要当前对象的地址。而静态成员函数可以通过类来直接调用，因为编译器不会为它增加形参this，它不需要当前对象的地址。

静态成员函数和普通成员函数的根本区别在于：普通成员函数有this指针，可以访问类中的任意成员；静态成员函数没有this指针，只能访问静态成员（包括静态成员变量和静态成员函数）

## const成员变量和成员函数

const成员变量和普通const变量的用法相似，只需要在声明时加上const关键字。初始化const成员变量只有一个方法，就是通过构造函数的初始化列表。

const成员函数可以使用类中的所有成员变量，但是不能修改它们的值，这种措施主要是为了保护数据，通常将get函数设置为常成员函数。

常成员函数在声明和定义的时候在函数头部的结尾加上const关键字。

```c++
int Student::getAge() const{}
```

## const对象

const修饰的对象，只能调用类的const成员，包括const成员变量和const成员函数。

## 友元函数（friend关键字）

借助友元（friend），可以使得其他类中的成员函数以及全局范围内的函数访问当前类的private成员。

友元函数可以是不属于任何类的非成员函数，也可以是其他类的成员函数，友元函数可以访问当前类中的所有成员，包括public、protected、private属性的。

```C++
class Student{
private：
    int m_age;
public:
    Student();
public:
    //友元函数
    friend void show(Student *pStu);
};

//非成员函数  友元函数中不能直接访问类的成员，必须要借助对象
void show(Student *pStu){
    pstu->m_age;
}
```

